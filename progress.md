# Progress

- Task 00 - discover_legacy_branding_and_extract_tokens (AgentPrompts/00_discover_legacy_branding.json): completed. Branding report delivered in chat using assets from `LegacyFormForStyle`.
- Task 01 - scaffold_replit_vite_react_express_with_branding (AgentPrompts/01_scaffold_replit_vite_react_express.json): completed. Root + client + server created with scripts, branding tokens, and Express static serving; client npm install rerun and `npm run dev` works.
- Task 02 - postgres_schema_and_migrations (AgentPrompts/02_postgres_schema.json): completed. Postgres schema and migrations delivered for extra hours tracking and payroll configuration keyed by FranchiseID.
- Task 03 - db_connectors_and_env_validation (AgentPrompts/03_db_connectors.json): completed. Added env validation, pooled Postgres and MSSQL connectors, documented required env vars and manual connection checks; both pool tests return `{ ok: 1 }`.
- Task intermediary - migrate_repo_to_typescript: completed. Server converted to `.ts` with `tsc` build to `server/dist`, client converted to `.tsx` with Vite TS config, scripts updated to use `tsx` for dev and `tsc` for server builds.
- Task 04 - auth_sessions_dual_source (AgentPrompts/04_auth_sessions.json): completed. Added MSSQL-backed admin/tutor login with timing-safe plaintext check, selection-token multi-account flow, 15-minute rolling server sessions, role guards, and lockout/backoff rate limiting; manual curl tests passing for login, /me, logout.
- Task 05 - pay_period_resolution_service (AgentPrompts/05_pay_period_service.json): completed. Implemented Luxon-based pay period resolver with settings defaults, override precedence (createdat/id tie-break), weekly/biweekly/semimonthly/monthly calculations, and UTC bounds; added GET /api/pay-period/current and /api/pay-period with admin/tutor scoping rules and validation. Admin sessions now retain MSSQL franchiseId for implicit scoping.
- Task 06 - hours_aggregation_and_calendar_api (AgentPrompts/06_hours_aggregation_and_calendar_api.json): completed. Added tutor weekly/pay-period/monthly hour aggregations and calendar endpoints using MSSQL slot dedupe, approved-only Postgres extra hours, Luxon franchise time ranges, and pay-period resolver outputs.
- Task 06b - admin_pay_period_summary_api (AgentPrompts/06b_admin_pay_period_summary.json): completed. Added admin-only pay-period summary endpoints (standard and total-positive), enforced requireAdmin, used task 05 resolver with override-first, MSSQL slot dedupe, approved Postgres extra hours, batch name lookup for extra-only tutors, and session-scoped franchise for admin calls.
- Task 07 - extra_hours_request_approval_email (AgentPrompts/07_extra_hours_request_approval_email.json): updated. Tutor POST now returns an emailDraft (mailto + Gmail compose + adminReviewUrl) instead of sending submission emails; admin decides via dashboard endpoints only with no self-approval, batched tutor lookups, optional decision emails behind flags, and append-only audit logging for create/cancel/approve/deny with no schema changes.
- Task 08 - time_off_requests_postgres_api_with_google_calendar (AgentPrompts/08_time_off_requests.json): completed per updated spec. Time off remains Postgres source of truth with create/list/cancel/decide/admin pending, session-derived tutor/franchise IDs, status transition enforcement, optional overlap guard, no self-approval, append-only audit logging, batched MSSQL tutor lookups, Google Calendar DWD approvals (subject/calendarId = franchise GmailID, store google_calendar_event_id, 502 on insert failure, 409 on pending rows with existing event), and refreshed tutor/admin UI cards (form + my list + admin pending actions with calendar id display).
- Task 09 - ui_overhaul_fullcalendar_shadcn (AgentPrompts/09_ui_overhaul_fullcalendar_shadcn.json): completed. Added Tailwind + shadcn/ui component set, FullCalendar month view, a cohesive AppShell (sidebar/topbar), role-based route guards, and full tutor/admin pages (dashboards, calendar overlay, extra hours, time off, approvals inbox, pay period summary with copy/export).
