<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Request for Time Off</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Company Logo -->
    <div class="company-logo">
        <svg id="company-logo-svg" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 612 792">
                  <!-- Generator: Adobe Illustrator 29.5.1, SVG Export Plug-In . SVG Version: 2.1.0 Build 141)  -->
                  <defs>
                    <style>
                      .st0 {
                        fill: #f28354;
                      }

                      .st1 {
                        fill: #487cb6;
                      }

                      .st2 {
                        fill: #ff5f0e;
                      }

                      .st3 {
                        fill: #ef6932;
                      }

                      .st4 {
                        fill: #ff5f0e;
                      }

                      .st5 {
                        fill: #0063ae;
                      }

                      .st6 {
                        fill: #0063ad;
                      }
                    </style>
                  </defs>
                  <path class="st0" d="M254.04,255.96c11.24-.27,21.97,7.13,26.16,18.4,6.73,18.11-.97,41.11-25.52,47.51h-.67c-.6-.65-.55-1.47-.55-2.25-.01-20.47-.01-40.94,0-61.41,0-.79.01-1.59.58-2.24Z"/>
                  <path class="st1" d="M390.58,212.34c-4.43,1.79-8.87,3.57-13.29,5.38-.35.14-.66.4-.99.6-.39.44-.9.68-1.42.9-9.6,4.18-19.08,8.63-28.65,12.86-1.86.82-3.67,1.78-5.56,2.54-1.15.46-1.6,1.26-1.58,2.5.05,3.45.03,6.91.01,10.36,0,.73.1,1.49-.47,2.09-4.28.6-8.6.43-12.88.22-9.56-.47-19.01-1.79-28.36-3.93-1.31-.3-1.58-.84-1.5-2.06.25-3.89.34-7.8.6-11.69.09-1.32-.41-1.53-1.6-1.63-11.94-1.01-23.86-2.09-36.32-3.2,1.11-.63,1.83-1.06,2.58-1.45,21.85-11.39,43.71-22.78,65.56-34.17.72-.38,1.41-.62,2.26-.49,11.95,1.88,23.89,3.75,35.84,5.6,12.79,1.98,25.58,3.94,38.37,5.91,2.44.38,4.89.76,7.45,1.53-3.35,1.34-6.7,2.68-10.04,4.02-2.19.68-4.47.72-6.7.7-6.22-.04-12.44.33-18.65.47-8.36.18-16.73.45-25.09.68-3.96.11-7.91.22-11.87.27-.97.01-1.92.14-2.86.36-1.12.27-1.83.92-1.81,2.12.03,1.03,1.02,1.82,2.35,1.69,2.15-.21,4.3-.11,6.44-.25,5.36-.36,10.72-.58,16.08-.93,5.58-.37,11.18-.49,16.76-.91,4.67-.36,9.37-.41,14.06-.68.5-.03,1.03.02,1.3.58Z"/>
                  <path class="st1" d="M339.97,261.09c-.2,15.39-.43,30.79-.32,46.18-3.42-.35-6.52-1.73-9.63-3.02-7.75-3.23-14.79-7.53-20.28-14.04-7.71-9.15-9.34-19.63-6.76-31.04.28-1.23.97-.93,1.75-.79,10.02,1.88,20.1,3,30.31,2.78,1.64-.04,3.28-.05,4.91-.07Z"/>
                  <path class="st2" d="M311.58,589.22c-2.09-3.43-3.28-7.9-3.28-13.12v-31.01h-9.69v-13.71h25.94v40.7c0,2.83.44,4.92,1.34,6.71,1.49,2.83,4.18,4.32,8.05,4.32,5.67,0,11.63-3.28,16.84-7.6v-30.41h-10.13v-13.71h26.38v51.87h9.69v13.42h-25.34v-10.43c-6.26,6.11-13.27,11.63-22.81,11.63-7.9,0-13.71-3.28-16.99-8.65"/>
                  <path class="st2" d="M399.08,590.41l-3.58,6.56h-11.03v-95.7h-9.84v-13.72h26.08v50.98c4.77-4.62,10.88-8.35,19.23-8.35,17.29,0,30.26,13.86,30.26,33.54s-13.72,34.13-31.3,34.13c-8.35,0-14.31-2.98-19.83-7.45M433.51,563.88c0-12.52-7.75-19.68-17.29-19.68-6.11,0-11.03,2.68-15.51,6.56v28.03c4.32,2.98,9.39,5.06,15.51,5.06,9.09,0,17.29-7.01,17.29-19.97"/>
                  <path class="st2" d="M243.67,571.64c-7.5,8.07-17.16,13.25-28.95,13.25-21.29,0-35.39-15.98-35.39-36.08s15.01-35.77,34.62-35.77c3,0,5.81.23,8.47.58,5.49.86,9.92,2.93,14.82,7.65,1.53,1.48,2.27,3.07,2.27,4.86v7.56h15.36c1-15.02-.89-17.07-1.66-18.38-1-1.7-1.78-2.85-3.14-4.28-4.48-5.70-13.11-10.71-23.62-12.81-2.33-.52-4.71-.96-7.19-1.20-1.58-.12-3.19-.19-4.85-.19-29.41,0-53.01,22-53.01,52.14s22.21,51.91,53.31,51.91c16.09,0,30.64-6.55,40.44-17.36l-11.49-11.87Z"/>
                  <path class="st2" d="M260.6,583.25h10.13v-81.98h-10.13v-13.71h26.38v95.69h9.69v13.42h-36.07v-13.42Z"/>
                  <path class="st3" d="M390.58,212.34c-2.59.08-5.18.11-7.77.25-13.48.74-26.95,1.5-40.43,2.26-2.09.12-4.17.22-6.26.34-1.85.11-3.16-.87-3.25-2.46-.09-1.49,1.01-2.64,2.81-2.7,7.97-.26,15.93-.45,23.9-.69,12.65-.38,25.3-.78,37.95-1.16,1.01-.03,2.03.04,3.04.06.08,8.19.17,16.39.25,24.58,0,.55,0,1.09,0,1.96-1.45-1.01-2.71-1.82-3.89-2.73-.74-.57-1.2-.55-1.79.21-1.24,1.58-2.58,3.08-4.23,5.03,0-2.84,0-5.18,0-7.53-.02-5.26-.05-10.51-.09-15.77,0-.56.11-1.14-.23-1.65Z"/>
                  <path class="st4" d="M254.04,255.96c0,21.97-.02,43.93-.03,65.9-12.25-3.06-26.16-13.1-27.93-31-.93-9.4,1.02-17.9,7.21-25.13,5.41-6.31,12.27-9.82,20.75-9.77Z"/>
                  <path class="st4" d="M327.3,367.55c1.19,4.83,2.26,9.68,2.67,14.66.17,2.09.81,4.44.03,6.2-.81,1.81-3.5,1.56-5.37,2.16-4.35,1.41-8.76,2.64-13.14,3.97-2.18.66-4.38.65-6.52-.02-2.79-.88-5-2.53-5.61-5.57-.63-3.16.87-5.62,3.04-7.7,2.13-2.04,4.72-3.3,7.65-3.75.99-.15,1.38-.44,1.46-1.55.59-8.92,1.27-17.82,1.91-26.74l.02-.68c.02-.72.28-1.6-.49-2.02-.89-.48-1.44.36-2.02.85-11.41,9.62-23.45,18.3-37.07,24.59-4.63,2.14-9.4,3.89-14.44,4.77-1.03.18-1.71.67-2.29,1.52-1.1,1.64-2.33,3.2-3.45,4.83-.5.73-.81.75-1.33.02-1.25-1.75-2.6-3.42-3.86-5.17-.46-.64-1-.99-1.77-1.14-8.56-1.6-16.31-5.27-23.8-9.54-9.36-5.34-18.08-11.61-26.33-18.54-.58-.49-1.18-1.32-2.04-.83-.81.45-.56,1.39-.53,2.17.39,8.81.79,17.63,1.16,26.44.04.95.2,1.42,1.34,1.63,4.11.77,7.56,2.68,9.7,6.44,1.43,2.5,1.59,5.07-.2,7.49-1.69,2.29-5.44,3.57-8.06,2.8-6.23-1.84-12.44-3.74-18.68-5.54-.99-.29-1.19-.73-1.17-1.66.37-18.18,6.61-34.03,18.95-47.39,8.67-9.39,19.31-15.73,31.47-19.6,1.22-.39,2-.28,2.97.64,4,3.79,8.57,6.79,13.35,9.54,6.47,3.72,12.71,3.52,19.13-.07,4.72-2.64,9.17-5.61,13.07-9.35,1.03-.98,1.95-1.31,3.26-.75.82.36,1.72.56,2.58.83.65-.3,1.21.04,1.79.25,8.45,3.19,16.06,7.72,22.84,13.73,9.25,8.21,15.42,18.37,19.51,29.92.24.68.58,1.37.29,2.14Z"/>
                  <path class="st5" d="M134.46,471.38c-1.96-3.22-3.08-7.42-3.08-12.32v-29.13h-9.1v-12.88h24.36v38.23c0,2.66.42,4.62,1.26,6.3,1.4,2.66,3.92,4.06,7.56,4.06,5.32,0,10.92-3.08,15.82-7.14v-28.57h-9.52v-12.88h24.79v48.73h9.1v12.6h-23.8v-9.8c-5.89,5.74-12.46,10.92-21.43,10.92-7.42,0-12.88-3.08-15.96-8.12"/>
                  <path class="st5" d="M208.95,471.1c-1.4-2.52-2.1-5.74-2.1-9.66v-31.5h-11.9v-12.89h11.9v-12.88l15.12-6.58v19.46h18.63v12.89h-18.63v28.57c0,1.96.28,3.22.98,4.48,1.12,1.96,3.36,2.94,6.44,2.94,3.92,0,8.4-1.54,12.05-3.22l-1.26,13.16c-4.2,2.1-9.1,3.64-14.71,3.64-7.42,0-13.44-2.52-16.52-8.4"/>
                  <path class="st5" d="M244.52,447.71c0-16.8,12.6-31.79,32.63-31.79s32.63,14.7,32.63,31.79-12.6,31.79-32.63,31.79-32.63-14.7-32.63-31.79M294.09,447.71c0-11.2-7-19.05-16.94-19.05s-16.94,7.84-16.94,19.05,7,19.05,16.94,19.05,16.94-7.84,16.94-19.05"/>
                  <path class="st5" d="M367.89,426.01c0,5.18-4.06,9.52-9.1,9.52-4.62,0-7.7-2.66-8.96-5.46-4.34,1.54-9.38,6.3-12.18,11.62v24.08h10.64v12.61h-35.01v-12.61h9.1v-35.84h-9.1v-12.89h23.8v13.86c5.18-8.26,11.62-14.98,19.47-14.98s11.34,4.62,11.34,10.08"/>
                  <path class="st5" d="M435.1,426.85c5.88-5.74,12.46-10.92,21.43-10.92,7.28,0,12.6,2.94,15.82,7.84,2.1,3.36,3.22,7.56,3.22,12.6v29.41h9.1v12.6h-32.77v-12.6h8.4v-25.62c0-2.52-.42-4.76-1.26-6.3-1.4-2.66-3.92-4.06-7.56-4.06-5.32,0-10.93,3.08-15.82,7.14v28.84h8.4v12.6h-32.77v-12.6h9.1v-35.85h-9.1v-12.88h23.8v9.8Z"/>
                  <path class="st5" d="M371.53,465.78h9.37v-35.82h-9.37v-12.87h24.62v48.68h9.09v12.59h-33.72v-12.59ZM376.85,397.65c0-5.59,4.9-10.07,10.35-10.07s10.07,4.48,10.07,10.07-4.9,10.07-10.35,10.07-10.07-4.48-10.07-10.07"/>
                  <path class="st5" d="M546.01,478.52c0,7.56-1.96,13.86-5.74,18.48-5.04,6.16-13.02,9.38-22.97,9.38-10.64,0-19.74-3.36-24.08-7.7-2.38-2.38-3.36-5.04-3.36-7.98,0-4.34,3.22-8.55,8.26-8.55,4.76,0,8.54,3.36,8.54,7.98,0,.7-.14,1.82-.28,2.38,2.52.84,5.46,1.54,9.1,1.54,5.46,0,9.8-1.68,12.46-5.32,1.82-2.52,2.8-6.02,2.8-10.64v-8.82c-4.62,4.62-9.52,7.84-17.64,7.84-15.55,0-28.01-11.9-28.01-30.11s12.74-31.09,28.71-31.09c7.84,0,13.45,3.08,17.5,6.58v-5.46h23.81v12.89h-9.1v48.59ZM500.78,446.87c0,11.2,6.86,17.36,16.24,17.36,5.18,0,9.8-2.38,13.73-6.02v-24.36c-3.64-2.8-8.26-4.76-13.73-4.76-9.38,0-16.24,6.16-16.24,17.78"/>
                  <polygon class="st5" points="56.89 386.33 56.89 409.17 71.82 409.17 71.82 400 88.83 400 88.83 478.22 96.69 482.32 104.59 478.22 104.59 400 121.62 400 121.62 409.17 136.54 409.17 136.54 386.33 56.89 386.33"/>
                  <path class="st6" d="M390,368.07c-13.98,0-27.96-.02-41.93.03-1.38,0-1.82-.32-1.81-1.76.05-13.69.05-27.39,0-41.08,0-1.23.41-1.76,1.51-2.21,8.29-3.4,16.38-7.28,23.14-13.21,2.57-2.26,4.4-2.17,7.15-.83,25.42,12.4,44.42,30.92,55.23,57.37.6,1.46.35,1.72-1.19,1.72-14.03-.05-28.07-.03-42.1-.03Z"/>
                  <path class="st6" d="M338.61,249.58c0-4.35.03-8.7-.02-13.05-.01-1.05.3-1.63,1.27-2.07,7.77-3.46,15.52-6.96,23.28-10.46,3.8-1.71,7.6-3.44,11.39-5.16.56-.26,1.09-.62,1.75-.53,1.32,5.36,2.6,10.74,4,16.08.36,1.37.1,2.02-1.22,2.68-11.91,6.02-24.31,10.5-37.59,12.3-.95.13-1.91.14-2.87.2Z"/>
                  <path class="st6" d="M339.97,261.09c11.52-1.15,22.38-4.67,32.92-9.29,1.17-.51,1.36.18,1.67.91,6.45,15.08,4.13,31.8-10.14,43.17-6.82,5.43-14.58,8.94-22.92,11.29-.62.17-1.22.18-1.84.1-.63-.63-.57-1.45-.58-2.23-.01-9.5-.18-19,.07-28.49.12-4.4.19-8.81.26-13.21.01-.79-.02-1.6.55-2.25Z"/>
                  <path class="st6" d="M327.3,367.55c-2.28-6.89-5.19-13.47-9.33-19.48-8.31-12.06-19.42-20.52-33.04-25.77-.68-.26-1.37-.53-2.05-.79,7.45-5.87,15.55-10.63,24.31-14.29.57-.24.99-.3,1.52.18,7.48,6.88,16.4,11.36,25.66,15.22,1.06.44,1.39,1,1.38,2.12-.04,13.69-.04,27.39,0,41.08,0,1.29-.28,1.77-1.66,1.71-2.26-.11-4.52,0-6.79,0Z"/>
                  <path class="st6" d="M386.88,407.82c-5.58,0-10.16-4.57-10.14-10.12.02-5.46,4.81-10.13,10.43-10.15,5.47-.02,10.19,4.71,10.17,10.17-.02,5.46-4.82,10.09-10.46,10.09Z"/>
                  <line class="st5" x1="524.12" y1="429.01" x2="524.22" y2="429.01"/>
                </svg>
    </div>

    <!-- For Google Apps Script deployment, comment out the inline SVG above and uncomment this line: -->
    <!-- <img src="path/to/TC_Stacked_logo.svg" alt="TC Logo" class="company-logo-file"> -->

    <div class="container">
        <!-- Header Section with Orange Background -->
        <header class="main-header">
            <h1>Request for Time Off</h1>
            <p class="instructions">Please complete and return this form to your supervisor. You must submit requests for absences, other than sick leave, 14 days prior to the first day you will be absent.</p>
        </header>
        
        <!-- Divider Line -->
        <div class="header-divider"></div>

        <!-- Form Body with Blue Background -->
        <div class="form-body">
            <form id="timeOffForm" class="time-off-form">
                <!-- Section 1: Employee Information (Always visible) -->
                <div class="form-section visible" id="section-employee-info">
                    <h3>Employee Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="employeeName">Employee Name *</label>
                            <input type="text" id="employeeName" name="employeeName" required>
                            <div id="employeeNameError" class="error-message"></div>
                        </div>
                        <div class="form-group">
                            <label for="todaysDate">Today's Date *</label>
                            <input type="date" id="todaysDate" name="todaysDate" required>
                            <div id="todaysDateError" class="error-message"></div>
                        </div>
                    </div>
                </div>

                <!-- Section 2: Calendar Integration (Appears after Employee Info) -->
                <div class="form-section" id="section-calendar" style="display: none;">
                    <h3>Select Time Off Dates</h3>
                    <div class="calendar-container">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="startDate">Start Date *</label>
                                <input type="date" id="startDate" name="startDate" required>
                                <div id="startDateError" class="error-message"></div>
                            </div>
                            <div class="form-group">
                                <label for="endDate">End Date *</label>
                                <input type="date" id="endDate" name="endDate" required>
                                <div id="endDateError" class="error-message"></div>
                            </div>
                        </div>
                        
                        <!-- Partial Day Option -->
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="partialDay" name="partialDay">
                                This is a partial day absence
                            </label>
                            <div id="partialDaySection" class="partial-day-section" style="display: none;">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="leaveTime">Leave Time</label>
                                        <input type="time" id="leaveTime" name="leaveTime">
                                    </div>
                                    <div class="form-group">
                                        <label for="returnTime">Return Time</label>
                                        <input type="time" id="returnTime" name="returnTime">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section 3: Absence Type (Appears after Calendar selection) -->
                <div class="form-section" id="section-absence-type" style="display: none;">
                    <h3>Type of Absence</h3>
                    <div class="form-group">
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="absenceType" value="vacation" required>
                                <span class="radio-custom"></span>
                                Vacation
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="absenceType" value="sick" required>
                                <span class="radio-custom"></span>
                                Sick Leave
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="absenceType" value="personal" required>
                                <span class="radio-custom"></span>
                                Personal Time
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="absenceType" value="bereavement" required>
                                <span class="radio-custom"></span>
                                Bereavement
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="absenceType" value="jury" required>
                                <span class="radio-custom"></span>
                                Jury Duty
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="absenceType" value="other" required>
                                <span class="radio-custom"></span>
                                Other
                            </label>
                        </div>
                        <input type="text" id="otherAbsenceType" name="otherAbsenceType" 
                               placeholder="Please specify other type of absence" 
                               style="margin-top: 10px; display: none;" disabled>
                        <div id="absenceTypeError" class="error-message"></div>
                    </div>
                </div>

                <!-- Section 4: Reason for Absence (Appears after Type selection) -->
                <div class="form-section" id="section-reason" style="display: none;">
                    <h3>Reason for Absence</h3>
                    <div class="form-group">
                        <label for="reason">Please provide a detailed reason for your absence request *</label>
                        <textarea id="reason" name="reason" 
                                  placeholder="Enter your reason for requesting time off..."
                                  required></textarea>
                        <div id="reasonError" class="error-message"></div>
                    </div>
                </div>

                <!-- Section 5: Employee Signature (Appears after Reason) -->
                <div class="form-section" id="section-signature" style="display: none;">
                    <h3>Employee Signature</h3>
                    <div class="form-group">
                        <div class="signature-group">
                            <label>Employee Signature *</label>
                            <div class="signature-container">
                                <canvas id="employeeSignature" width="400" height="150"></canvas>
                                <button type="button" id="clearEmployeeSignature" class="clear-signature">Clear</button>
                            </div>
                            <div id="employeeSignatureError" class="error-message"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="employeeSignatureDate">Date *</label>
                        <input type="date" id="employeeSignatureDate" name="employeeSignatureDate" required>
                        <div id="employeeSignatureDateError" class="error-message"></div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" id="finalSubmitBtn" class="submit-btn" disabled>Submit</button>
                    </div>
                </div>

                <!-- Section 6: Email Generation (Appears after Signature) -->
                <!-- This section is now removed in favor of the new submit button -->
            </form>

            <!-- Success Message -->
            <div id="successMessage" class="success-message" style="display: none;">
                <h3>Form Submitted Successfully!</h3>
                <p>Your time-off request has been submitted and will be reviewed by your supervisor.</p>
            </div>
        </div>
    </div>

    <script src="signature-pad.js"></script>
    <script src="dynamic-form.js"></script>
    <script src="script.js"></script>
</body>
</html>